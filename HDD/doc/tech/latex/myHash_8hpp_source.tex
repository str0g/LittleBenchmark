\hypertarget{myHash_8hpp_source}{
\section{myHash.hpp}
}


\begin{footnotesize}\begin{alltt}
00001 \textcolor{preprocessor}{#ifndef MYHASH\_HPP\_INCLUDED}
00002 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define MYHASH\_HPP\_INCLUDED}
00003 \textcolor{preprocessor}{}
00004 \textcolor{comment}{/***************************************************************}
00005 \textcolor{comment}{ * Name:      <Input name>.cpp/h}
00006 \textcolor{comment}{ * Purpose:   Code for Application <Name>}
00007 \textcolor{comment}{ * Author:    Łukasz Buśko (buskol.waw.pl@gmail.com)}
00008 \textcolor{comment}{ * Created:   <Input date>}
00009 \textcolor{comment}{ * Copyright: Łukasz Buśko (http://str0g.wordpress.com)}
00010 \textcolor{comment}{ * License:   GNU / General Public Licens}
00011 \textcolor{comment}{ **************************************************************/}
00012 \textcolor{comment}{//Headers}
00013 \textcolor{preprocessor}{#define SHA512LEN 128}
00014 \textcolor{preprocessor}{}\textcolor{preprocessor}{#include "Globals.h"}
00015 \textcolor{preprocessor}{#ifndef COMPILE\_WITH\_CRYPTOPP}
00016 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #define COMPILE\_WITH\_CRYPTOPP 1}
00017 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif}
00018 \textcolor{preprocessor}{}
00019 \textcolor{preprocessor}{#if COMPILE\_WITH\_CRYPTOPP == 1}
00020 \textcolor{preprocessor}{}
00021 \textcolor{preprocessor}{#define CRYPTOPP\_ENABLE\_NAMESPACE\_WEAK 1}
00022 \textcolor{preprocessor}{}\textcolor{preprocessor}{#include <string>}
00023 \textcolor{preprocessor}{#if ( \_WIN32 ||  \_WIN64) || ( \_\_WIN32\_\_ || \_\_WIN64\_\_ )}
00024 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #include "md5.h"}
00025 \textcolor{preprocessor}{    #include "rsa.h"}
00026 \textcolor{preprocessor}{    #include "base64.h"}
00027 \textcolor{preprocessor}{    #include "hex.h"}
00028 \textcolor{preprocessor}{#else}
00029 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #include <cryptopp/md5.h>}
00030 \textcolor{preprocessor}{    #include <cryptopp/rsa.h>}
00031 \textcolor{preprocessor}{    #include <cryptopp/base64.h>}
00032 \textcolor{preprocessor}{    #include "cryptopp/hex.h"}
00033 \textcolor{preprocessor}{#endif}
00034 \textcolor{preprocessor}{}
00035 \textcolor{comment}{//Specials}
00036 \textcolor{comment}{//Globals Varuabels}
00040 \textcolor{comment}{}\textcolor{keyword}{namespace }Hash
00041 \{
00042         \textcolor{comment}{//Hash data by MD5 algorhitm}
00043         \textcolor{keyword}{inline} std::string MD5(\textcolor{keyword}{const} std::string &data)
00044         \{
00045                 std::string res;
00046                 CryptoPP::Weak1::MD5 hash;
00047                 byte digest[CryptoPP::Weak1::MD5::DIGESTSIZE];
00048 
00049                 hash.CalculateDigest(digest, (byte*)data.c\_str(), data.size());
00050 
00051                 CryptoPP::HexEncoder encoder;
00052                 encoder.Attach(\textcolor{keyword}{new} CryptoPP::StringSink(res));
00053                 encoder.Put(digest, \textcolor{keyword}{sizeof}(digest));
00054                 encoder.MessageEnd();
00055 
00056                 \textcolor{keywordflow}{return} res;
00057         \}
00058 
00059         \textcolor{comment}{//Hash data by SHA512 algorhitm}
00060         \textcolor{keyword}{inline} std::string SHA512(\textcolor{keyword}{const} std::string &data)
00061         \{
00062                 std::string res;
00063                 CryptoPP::SHA512 hash;
00064 
00065                 CryptoPP::StringSource encoder(data, \textcolor{keyword}{true},
00066                         \textcolor{keyword}{new} CryptoPP::HashFilter(hash, \textcolor{keyword}{new} CryptoPP::HexEncoder(\textcolor{keyword}{n
      ew} CryptoPP::StringSink(res))));
00067 
00068                 \textcolor{keywordflow}{return} res;
00069         \}
00070 \}
00071 \textcolor{preprocessor}{    #endif //COMPILE\_WITH\_CRYPTOPP}
00072 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif // MYHASH\_HPP\_INCLUDED}
\end{alltt}\end{footnotesize}
